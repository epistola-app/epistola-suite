/*
 * Preview Panel + Resize Handle
 *
 * The preview panel displays a server-rendered PDF in an iframe.
 * The resize handle sits between canvas and preview, allowing
 * the user to drag to resize the preview width.
 */

@layer components {
  /* ------------------------------------------------------------------ */
  /* Preview panel                                                       */
  /* ------------------------------------------------------------------ */

  epistola-preview {
    display: flex;
    flex-direction: column;
    width: var(--ep-preview-width, 400px);
    flex-shrink: 0;
    background: var(--ep-white);
    overflow: hidden;
  }

  .preview-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--ep-space-1-5) var(--ep-space-3);
    height: 2rem;
    border-bottom: 1px solid var(--ep-gray-200);
    flex-shrink: 0;
  }

  .preview-header-title {
    font-size: var(--ep-text-xs);
    font-weight: 600;
    color: var(--ep-gray-600);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .preview-header-status {
    display: inline-flex;
    align-items: center;
    gap: var(--ep-space-1);
    font-size: var(--ep-text-xs);
    color: var(--ep-gray-400);

    & svg {
      animation: ep-spin 1s linear infinite;
    }
  }

  .preview-content {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .preview-iframe {
    width: 100%;
    height: 100%;
    border: none;
    flex: 1;
  }

  .preview-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--ep-space-2);
    height: 100%;
    color: var(--ep-gray-400);
    font-size: var(--ep-text-sm);

    & .preview-placeholder-icon {
      color: var(--ep-gray-300);
    }
  }

  .preview-spinner svg {
    animation: ep-spin 1s linear infinite;
    color: var(--ep-blue-500);
  }

  .preview-error {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--ep-space-2);
    height: 100%;
    padding: var(--ep-space-4);
    text-align: center;
  }

  .preview-error-icon {
    color: var(--ep-amber-500, #f59e0b);
  }

  .preview-error-message {
    font-size: var(--ep-text-sm);
    color: var(--ep-gray-600);
    max-width: 20rem;
    word-break: break-word;
  }

  .preview-retry-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--ep-space-1);
    padding: var(--ep-space-1) var(--ep-space-3);
    font-size: var(--ep-text-xs);
    font-weight: 500;
    color: var(--ep-blue-600);
    background: var(--ep-blue-50, #eff6ff);
    border: 1px solid var(--ep-blue-200, #bfdbfe);
    border-radius: var(--ep-radius-sm);
    cursor: pointer;
    transition:
      background-color var(--ep-transition-fast),
      border-color var(--ep-transition-fast);

    &:hover {
      background: var(--ep-blue-100, #dbeafe);
      border-color: var(--ep-blue-300, #93c5fd);
    }

    &:active {
      background: var(--ep-blue-200, #bfdbfe);
    }
  }

  /* ------------------------------------------------------------------ */
  /* Resize handle                                                       */
  /* ------------------------------------------------------------------ */

  epistola-resize-handle {
    display: flex;
    align-items: stretch;
    flex-shrink: 0;
    touch-action: none;
  }

  .resize-handle {
    width: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: col-resize;
    background: var(--ep-gray-100);
    transition: background-color var(--ep-transition-fast);

    &:hover,
    &:active {
      background: var(--ep-blue-100, #dbeafe);
    }
  }

  .resize-handle-grip {
    width: 2px;
    height: 24px;
    border-radius: 1px;
    background: var(--ep-gray-300);
    transition: background-color var(--ep-transition-fast);

    .resize-handle:hover &,
    .resize-handle:active & {
      background: var(--ep-blue-400, #60a5fa);
    }
  }

  /* ------------------------------------------------------------------ */
  /* Spinner animation                                                   */
  /* ------------------------------------------------------------------ */

  @keyframes ep-spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
}
