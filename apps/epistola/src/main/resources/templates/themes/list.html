<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<body>
    <th:block th:fragment="content">
        <div class="page-header">
            <h1>Themes</h1>
            <div class="page-actions">
                <div th:replace="~{fragments/search :: search-box(
                    placeholder='Search themes...',
                    searchUrl=@{/tenants/{tenantId}/themes/search(tenantId=${tenantId})},
                    targetId='theme-rows'
                )}"></div>
                <a th:href="@{/tenants/{tenantId}/themes/new(tenantId=${tenantId})}" class="btn btn-primary">
                    <th:block th:replace="~{fragments/icon :: icon(name='plus', class='ep-icon')}" />
                    New Theme
                </a>
            </div>
        </div>

        <div th:if="${#lists.isEmpty(themes)}" class="empty-state">
            <div class="empty-state-icon">
                <th:block th:replace="~{fragments/icon :: icon(name='palette', class='ep-icon ep-icon-xl')}" />
            </div>
            <div class="empty-state-title">No themes yet</div>
            <div class="empty-state-description">Create a theme to define the visual styling of your documents.</div>
            <a th:href="@{/tenants/{tenantId}/themes/new(tenantId=${tenantId})}" class="btn btn-primary" style="margin-top: var(--ep-space-4);">
                <th:block th:replace="~{fragments/icon :: icon(name='plus', class='ep-icon')}" />
                New Theme
            </a>
        </div>

        <table th:if="${!#lists.isEmpty(themes)}" class="ep-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Last Modified</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="theme-rows">
                <th:block th:fragment="rows">
                    <tr th:each="theme : ${themes}">
                        <td>
                            <a th:href="@{/tenants/{tenantId}/themes/{themeId}(tenantId=${tenantId},themeId=${theme.id})}"
                               th:text="${theme.name}" style="font-weight: 500;"></a>
                            <span th:if="${tenant?.defaultThemeId == theme.id}" class="badge badge-primary" style="margin-left: var(--ep-space-2);">Default</span>
                        </td>
                        <td>
                            <span th:if="${theme.description != null}" th:text="${theme.description}" class="text-truncate"></span>
                            <span th:unless="${theme.description != null}" class="text-muted">-</span>
                        </td>
                        <td th:text="${#temporals.format(theme.lastModified, 'yyyy-MM-dd HH:mm')}"></td>
                        <td class="actions">
                            <a th:href="@{/tenants/{tenantId}/themes/{themeId}(tenantId=${tenantId},themeId=${theme.id})}"
                               class="btn btn-sm btn-icon btn-ghost" title="Edit theme">
                                <th:block th:replace="~{fragments/icon :: icon(name='pencil', class='ep-icon ep-icon-sm')}" />
                            </a>
                            <form th:unless="${tenant?.defaultThemeId == theme.id}"
                                  th:hx-post="@{/tenants/{tenantId}/default-theme(tenantId=${tenantId})}"
                                  hx-target="#theme-rows"
                                  hx-swap="innerHTML"
                                  style="display: inline;">
                                <input type="hidden" name="themeId" th:value="${theme.id}">
                                <button type="submit" class="btn btn-sm btn-icon btn-ghost" title="Set as default">
                                    <th:block th:replace="~{fragments/icon :: icon(name='star', class='ep-icon ep-icon-sm')}" />
                                </button>
                            </form>
                            <button th:if="${tenant?.defaultThemeId != theme.id and #lists.size(themes) > 1}"
                                    type="button"
                                    class="btn btn-sm btn-icon btn-ghost btn-ghost-destructive"
                                    title="Delete theme"
                                    data-confirm-title="Delete Theme"
                                    th:attr="data-confirm-message='Delete theme &quot;' + ${theme.name} + '&quot;? Templates using it will fall back to their own styles.',data-confirm-url=@{/tenants/{tenantId}/themes/{themeId}/delete(tenantId=${tenantId},themeId=${theme.id})}"
                                    data-confirm-target="#theme-rows"
                                    onclick="openConfirmDialog(this)">
                                <th:block th:replace="~{fragments/icon :: icon(name='trash-2', class='ep-icon ep-icon-sm')}" />
                            </button>
                        </td>
                    </tr>
                </th:block>
            </tbody>
        </table>

        <th:block th:replace="~{fragments/confirm-dialog :: confirm-dialog}" />
    </th:block>
</body>
</html>
